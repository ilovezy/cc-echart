<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title></title>
    <link rel="stylesheet" href="bootstrap-3.2.0-dist/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="css/cc-echarts.css">
</head>

<body>
    <div class="container">
        <h2 class="text-center">3线折线图，2个Y坐标系</h2>
        <!-- Button trigger modal -->
        <button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal">
            Launch demo modal
        </button>

        <!-- Modal -->
        <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
            <div class="modal-dialog" role="document">
                <div class="modal-content modal-lg">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="myModalLabel">Modal title</h4>
                    </div>
                    <div class="modal-body" id="main" style="height: 600px">
                        ...
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary">Save changes</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/jquery-1.11.1.min.js"></script>
    <script src="bootstrap-3.2.0-dist/js/bootstrap.min.js"></script>
    <script src="echarts-2.2.7/build/dist/echarts.js"></script>
    <script>
    // 按钮名字 图示
    // 日期为 x ，价格，净值，本金
    $('#myModal').on('shown.bs.modal', function(e) {

        $.ajax({
            url: 'data/CalciPush-jsonp.json'
        })
        .done(function(data) {
            var PushData = data.PushData;
            var lineChartData = {
                ExchangeDateArr: [],
                ClosePriceArr: [],
                MySumArr: [],
                MyTotalArr: []
            };

            $.each(PushData, function(index, val) {
                lineChartData.ExchangeDateArr.push(val.ExchangeDate.substring(0, 10));
                lineChartData.ClosePriceArr.push((+val.ClosePrice).toFixed(2));
                lineChartData.MySumArr.push((+val.MySum).toFixed(2));
                lineChartData.MyTotalArr.push((+val.MyTotal).toFixed(2));
            });
            // 到这里为止已经获取了所有需要的数据了

            // 开始绘制 3线的 line 图
            require.config({
                paths: {
                    echarts: 'echarts-2.2.7/build/dist/'
                }
            });
            require(['echarts', 'echarts/chart/line', 'echarts/chart/bar'], function(ec) {
                var myChart = ec.init(document.getElementById('main'), 'macarons');

                var option = {
                    title: {
                        text: '定值模拟计算',
                        x: 'center'
                    },
                    tooltip: {
                        trigger: 'axis',
                        formatter: function(params) {
                            return params[0].name + '<br/>' + params[0].seriesName + ' : ' + params[0].value + ' (元)<br/>' + params[1].seriesName + ' : ' + params[1].value + ' (元)<br/>' + params[2].seriesName + ' : ' + params[2].value + ' (元)';
                        }
                    },
                    legend: {
                        data: [ '价格','净值', '本金'],
                        x: 'left'
                    },
                    toolbox: {
                        show: true,
                        feature: {
                            mark: {
                                show: true
                            },
                            dataView: {
                                show: true,
                                readOnly: false
                            },
                            magicType: {
                                show: true,
                                type: ['line', 'bar']
                            },
                            restore: {
                                show: true
                            },
                            saveAsImage: {
                                show: true
                            }
                        }
                    },
                    dataZoom: {
                        show: true,
                        realtime: true,
                        start: 0,
                        end: 100
                    },
                    xAxis: [{
                        type: 'category',
                        boundaryGap: false,
                        axisLine: {
                            onZero: false
                        },
                        data: lineChartData.ExchangeDateArr
                    }],
                    yAxis: [{
                        name: '净值和本金（元）',
                        type: 'value'
                    }, {
                        name: '价格(元)',
                        type: 'value',
                        // axisLabel: {
                        //     formatter: function(v) {
                        //         return -v;
                        //         // return v
                        //     }
                        // }
                    }],
                    series: [ {
                        name: '价格',
                        type: 'line',
                        yAxisIndex: 1,
                        data: lineChartData.ClosePriceArr
                    },{
                        name: '净值',
                        type: 'line',
                        data: lineChartData.MySumArr
                    }, {
                        name: '本金',
                        type: 'line',
                        data: lineChartData.MyTotalArr
                    }]
                };

                myChart.setOption(option)
            })

        })
    })
    </script>
</body>

</html>
